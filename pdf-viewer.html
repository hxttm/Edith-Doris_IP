<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dream — PDF Viewer</title>
  <link rel="stylesheet" href="./phone.css" />
  <style>
    .pdf_viewer { height: 100vh; padding: 20px; }
    #pdfViewer { width: 100%; height: 90vh; border-radius: 16px; }
  </style>
</head>
<body>
  <div class="dreampage dreampage_has_nav">
    <main class="ui_screen pdf_viewer" aria-label="PDF Viewer">
      <header class="ui_top">
        <a class="ui_back" href="./your-notes.html" aria-label="Back">‹</a>
        <div class="ui_title" id="pdfTitle">Loading...</div>
        <div class="ui_top_spacer"></div>
      </header>

      <object id="pdfViewer" type="application/pdf" data="">
        <p>PDF not supported. <a id="pdfDownload" href="" download>Download PDF</a></p>
      </object>
    </main>

    <nav class="ui_nav">
      <a class="ui_nav_item" href="./buddy.html"><img class="ui_nav_icon" src="./assets/nav/avatar.png" alt="" /></a>
      <a class="ui_nav_item ui_nav_item_active" href="./your-notes.html"><img class="ui_nav_icon" src="./assets/nav/market.png" alt="" /></a>
      <a class="ui_nav_item" href="./index.html"><img class="ui_nav_icon" src="./assets/nav/home.png" alt="" /></a>
      <a class="ui_nav_item" href="./chat.html"><img class="ui_nav_icon" src="./assets/nav/chat.png" alt="" /></a>
      <a class="ui_nav_item" href="./settings.html"><img class="ui_nav_icon" src="./assets/nav/settings.png" alt="" /></a>
    </nav>
  </div>

  <script>
    const buddy = localStorage.getItem("dream_buddy") || "blue";
    document.body.classList.toggle("orange", buddy === "orange");
    document.body.classList.toggle("blue", buddy !== "orange");

    const urlParams = new URLSearchParams(window.location.search);
    const filePath = urlParams.get('file');
    const pdfViewer = document.getElementById('pdfViewer');
    const pdfTitle = document.getElementById('pdfTitle');
    const pdfDownload = document.getElementById('pdfDownload');

    if (filePath) {
      pdfViewer.data = filePath;
      pdfDownload.href = filePath;
      pdfTitle.textContent = filePath.split('/').pop().replace('.pdf', '');
    } else {
      pdfTitle.textContent = 'No PDF selected';
    }

    document.querySelector(".ui_back").addEventListener("click", (e) => {
      if (history.length > 1) {
        e.preventDefault();
        history.back();
      }
    });
  </script>
</body>
</html>
